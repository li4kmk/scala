Конвертация из Excel в JSON. Данные читаются из двух листов Excel (тарелки и штрудели), обрабатываются, формируются структурированные запросы, результат сохраняется в JSON-файл.

1. Инициализация и загрузка Excel-файла
Вывод текущей рабочей директории.
Загрузка Excel-файл по указанному пути (fileSource).
Открываем два листа: тарелки и штрудели.

2. Функция для чтения значений ячеек
getCellValue — вспомогательная функция, которая читает значение ячейки в виде строки, даже если ячейка содержит числа или формулы.

3. Обработка листа тарелки
Скрипт проходит по строкам листа тарелки и извлекает данные из столбцов:
  sourceTableName (столбец 0) — имя таблицы.
  incriment (столбец 6) — ключ для данных.
  sourceFieldName (столбец 3) — значение, связанное с ключом.
Данные сохраняются в словарь dct, где ключом является sourceTableName, а значением — вложенный словарь с данными из столбцов incriment и sourceFieldName.
Также определяется значение format_date на основе содержимого ключей.

4. Обработка листа штрудели
Скрипт проходит по строкам листа штрудели и извлекает значение из столбца max_rows (столбец 5).
Если значение отсутствует или не может быть преобразовано в число, используется значение по умолчанию (10000000).
Данные сохраняются в словарь dctRows, где ключом является TARGETTABLENAME (столбец 0), а значением — словарь с ключом max_rows.

4. Обработка условий
Скрипт проходит по строкам листа тарелки и извлекает условия из столбцов:
  sourceTableName (столбец 0) — имя таблицы.
  sourceFieldName (столбец 3) — поле.
  condition (столбец 4) — оператор условия.
  value (столбец 5) — значение условия.
Условия сохраняются в словарь dctCondition, где ключом является sourceTableName, а значением — строка с условием.

6. Формирование запросов
Функция createQuery формирует структурированные запросы на основе данных из словарей dct, dctRows и dctCondition.
Для каждой таблицы создается запись, содержащая:
  Имя таблицы (table_name).
  Список колонок (columns).
  Условие (where), по умолчанию 1=1.
  Данные из dct (например, incriment и format_date).
  Значение max_rows из dctRows (или значение по умолчанию, если отсутствует).
  Условия из dctCondition, если они есть.

7. Сохранение результата в JSON
Результат (список запросов) преобразуется в JSON-строку с использованием библиотеки json4s.
